<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dashboard</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
  </head>
  <body class="p-3 mb-2 bg-info-subtle text-emphasis-info">

    <nav class="navbar fixed-top bg-body-tertiary" >
      <div class="container-fluid" style="text-align: center;">
        <h3>Attendance Management Sytem</h3>
      </div>
    </nav>

    <div class="row" style="padding-left:10px;padding-top:65px">
        <div class="col-4" style="padding-right: 85px">
          <div class="shadow p-3 mb-5 bg-body-tertiary rounded">
            <div class="card" style="width: 18rem">
              <img
                src="https://img.freepik.com/premium-vector/boy-student-graduate-cap-icon-sign-logo-color-isolated-image-circle-isolated-vector-illustration_619989-1110.jpg"
                class="card-img-top"
                style="height: 275px; width: 275px"
              />
              <div class="card-body">
                <h5 class="card-title" style="padding-top: 5px">
                  Student Name : <%= student.student_fullName %>
                </h5>
                <p class="card-text"></p>
              </div>
              <ul class="list-group list-group-flush">
                <li class="list-group-item">USN: <%= student.student_id %></li>
                <li class="list-group-item">Student email: <%= student.student_email %></li>
                <li class="list-group-item">Student Department: <%= student.student_dept %></li>
                <li class="list-group-item">Student Class: <%= student.student_class_name %></li>
              </ul>
            </div>
          </div>
        </div>

        <div class="col-8" style="padding-left: 0px">
            <div class="shadow p-3 mb-5 bg-body-tertiary rounded" style="padding-bottom: 5px;">
              <table class="table">
                <thead>
                  <tr>
                    <th scope="col">Course</th>
                    <th scope="col">Course Code</th>
                    <th scope="col">Professor</th>
                    <th scope="col">Last 5 days</th>
                    <th scope="col">Cumulative</th>
                  </tr>
                </thead>
                <tbody>
                  <% for (const course of selectedClass.class_courses) { %>
                    <% const studentAttendance = course.course_attendance.find(attendance => attendance.student_name === student.student_fullName); %>
                    <tr>
                      <td><%= course.course_name %></td>
                      <td><%= course.course_code %></td>
                      <td><%= course.course_teacher %></td>
                      <td>
                        <% if (studentAttendance) { %>
                          <ul>
                            <% for (const history of studentAttendance.student_history) { %>
                              <li><%= history %></li>
                            <% } %>
                          </ul>
                        <% } else { %>
                          No attendance history found.
                        <% } %>
                      </td>
                      <td>
                        <div
                          class="progress"
                          role="progressbar"
                          aria-label="Progress"
                          aria-valuenow="<%= studentAttendance ? studentAttendance.student_cumulative : 0 %>"
                          aria-valuemin="0"
                          aria-valuemax="<%= course.course_cumulative %>"
                        >
                          <div
                            class="progress-bar progress-bar-striped bg-info"
                            style="width: 75%"
                          ></div>
                        </div>
                      </td>
                    </tr>
                  <% } %>
                </tbody>
              </table>
            </div>
          </div>
    

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
      integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
