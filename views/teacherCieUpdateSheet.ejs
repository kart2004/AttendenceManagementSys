<!DOCTYPE html>
<html lang="en">

<head>
  
    <meta charset="UTF-8"><head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Teacher Class</title>
        <link
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
          crossorigin="anonymous"
        />
      </head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Student Attendance</title>
    <!-- Add your additional head content here -->
<script type="text/javascript">
    function changeBorderColor() {
      console.log("here")
      var selects = document.getElementsByClassName("customSelect");
      console.log(selects)
      for (let select of selects) {
        console.log(select)
        
        var selectedOption = select.options[select.selectedIndex];
  
        if (selectedOption.value === "1") {
          select.style.borderColor = "#28a745"; // Green border for 'P'
          select.style.backgroundColor = "#c2e2ca"; // Green border for 'P'
        } else {
          select.style.borderColor = "#dc3545"; // Red border for 'A'
          select.style.backgroundColor = "#e5aab1"; // Red border for 'A'
        }
    } 
    }
  </script>
</head>

<body class="p-3 mb-2 bg-success-subtle text-emphasis-success">
  <nav class="navbar fixed-top bg-body-tertiary" style = "padding: 0px;">
    <a class="navbar-brand" href="#" style = "font-size: xx-large; font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;">
      <img src="https://media.licdn.com/dms/image/D560BAQFEZtCmByGTGg/company-logo_200_200/0/1700567297525/rvcengineering_logo?e=2147483647&v=beta&t=1zpXDy-M1aBXcTFAQ-n38CUaceJxHPf8IbfPDcCuHbo" style = "padding-left: 10px; padding-right: 15px;" height="50" class="d-inline-block align-top" alt="">
      Attendance Management Sytem
    </a>
  </nav>
    <div class="row" style="padding-top: 70px; padding-left: 15px; padding-right: 15px; font-size: large;">
      <div class="col-5" style="padding-right: 15px">
        <div class="shadow p-3 mb-5 bg-body-tertiary rounded">
          <li style="list-style-type: none;"><b>Teacher: </b><%= matchingCourse.course_teacher %> </li>
          <hr />
          <li style="list-style-type: none;"><b>Class: </b><%= selectedClass.class_name %></li>
        </div>
      </div>
      <div class="col-7" style="padding-right: 15px">
        <div class="shadow p-3 mb-5 bg-body-tertiary rounded">
          <li style="list-style-type: none;"><b>Course: </b><%= matchingCourse.course_name %> </li>
          <hr />
          <li style="list-style-type: none;"><b>Course Code : </b><%= matchingCourse.course_code %> </li>
        </div>
      </div>

    </div>
<h2 style="text-align: center; padding-bottom: 0px">Student Marks</h2>
<hr />
<div class="row" style="padding-left: 15px; padding-right: 15px">
  <div class="shadow p-3 mb-5 bg-body-tertiary rounded">
    <div style = "text-align: right; margin-bottom: 2%; margin-right: 2%;">
    </div>
    <form action="http://localhost:4000/teacher/cie/update/<%= selectedClass.class_name %>/<%= matchingCourse.course_teacher %>" method="post">
      <label for="history" style = "font-weight: 500; font-size: large;"></label>
      <button type="submit" name="history" class="btn btn-info" style="background-color: green; color: azure; border-color: green; font-size: larger; font-weight: 500;">Update</button>
    </form>
    <h6 style = "text-align: right; font-style: italic;"> Last updated on <%= matchingCourse.course_last_updated.substring(0,10)%> at <%= matchingCourse.course_last_updated.substring(11)%> </h6>
    <form action="http://localhost:4000/teacher/cie/storeval/<%= selectedClass.class_name %>/<%= matchingCourse.course_teacher %>" method="post">
    <table class="table" style="width: 100%; text-align: center; table-layout: auto;">
      <thead>
        <tr>
          <th scope="col" style = "vertical-align: middle; text-align: left; width: 10%">Student Name</th>
          <th scope="col" style = "vertical-align: middle; text-align: left; width: 5%">Student USN</th>
          <th scope="col" style = "text-align: left; width: 3%;">  Quiz 1</th>
          <th scope="col" style = "text-align: left; width: 3%;">  Test 1</th>
          <th scope="col" style = "text-align: left; width: 3%;">  Quiz 2</th>
          <th scope="col" style = "text-align: left; width: 3%;">  Test 2</th>
          <th scope="col" style = "text-align: left; width: 3%;">  Quiz 3</th>
          <th scope="col" style = "text-align: left; width: 3%;">  Test 3</th>
          <th scope="col" style = "text-align: left; width: 3%;">  Lab</th>
          <th scope="col" style = "text-align: left; width: 3%;">  EL</th>
          <th scope="col" style = "text-align: left; width: 3%;"> Avg Quiz</th>
          <th scope="col" style = "text-align: left; width: 3%;"> Avg Test</th>
          <th scope="col" style = "vertical-align: middle; width : 4%;">Attendance</th>
          <!-- <th scope="col" style = "vertical-align: middle; width : 5%;">Cumulative</th> -->
        </tr>
      </thead>
      <tbody>
        <% for (let i = 0; i < studentAttendance.length; i++) { %>
            <% const studentCumulative = (studentAttendance[i].student_cumulative / matchingCourse.course_cumulative * 100).toFixed(2) + '%'; %>
          <tr>
            <td style = "text-align: left;"><%= studentAttendance[i].student_name %></td>
            <td style = "text-align: left;"><%= studentAttendance[i].student_usn %></td>
            <% const studentMarks = studentAttendance[i].student_marks; %>

        <% for (let j = 0; j < 8; j++) { %>
          <td>
                  <input type = "number" size = "3" style = "width : 90%;" name="<%= studentAttendance[i].student_usn + '' + j %>" value = "<%= studentMarks[j] %>"/>
          </td>
          <% } %>

        <!-- Avg quiz -->
        <td>
          <%= ((parseInt(studentMarks[0]) + parseInt(studentMarks[2]) + parseInt(studentMarks[4]))/3.0).toFixed(2) %>
        </td>
        <!-- Avg test -->
        <td>
          <%= ((parseInt(studentMarks[1]) + parseInt(studentMarks[3]) + parseInt(studentMarks[5]))/3.0).toFixed(2) %>
        </td>

            <!-- <td><div
                class="progress"
                role="progressbar"
                aria-label="Warning striped example"
                aria-valuenow="<%= studentAttendance[i].student_cumulative %>"
                aria-valuemin="0"
                aria-valuemax="<%= matchingCourse.course_cumulative %>"
              >
                <div
                  class="progress-bar progress-bar-striped bg-warning"
                  style="width: <%= studentCumulative %>; color: black;
                  background-color: <%= (studentAttendance[i].student_cumulative / matchingCourse.course_cumulative * 100).toFixed(2) > 65 ? '#00e600' : (studentAttendance[i].student_cumulative / matchingCourse.course_cumulative * 100).toFixed(2) > 40 ? '#ffff00' :'#ff4d4d' %>
                                !important;"
                >
                <%= studentCumulative %>
                </div>
              </div></td> -->

                <td style = "text-align: center;"><%= studentCumulative + '      [ ' + studentAttendance[i].student_cumulative + '/' + matchingCourse.course_cumulative + ' ]'%></td>
                

          
            </tr>
            <% } %>
            
          </tbody>
          
          <!-- <form action="http://localhost:4000/attendance/updateAllAttendances/<%= selectedClass.class_name %>/<%= matchingCourse.course_teacher %>" method="post">
            <label for="attendance" style = "font-weight: 500; font-size: large;">Click here for a new class: </label>
        <button type="submit" name="attendance" value="1" class="btn btn-info" style="background-color: green; color: azure; border-color: green; font-size: larger; font-weight: 500;">New Session</button>
      </form> -->
      
    </table>
    <div style = "text-align: right;">
      <button type="submit" name="Submit" class="btn btn-info" style="background-color: green; color: azure; border-color: green; font-size: large; font-weight: 500; ">Submit Marks</button>
    </div>
</body>


</html>
